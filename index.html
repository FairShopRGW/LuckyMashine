<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Slots - Jackpot & Music Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

        :root {
            --neon-color: #00ffff;
            --bg-color: #050505;
            --jackpot-color: #ffcc00;
        }

        body {
            background-color: var(--bg-color);
            color: white;
            font-family: 'Orbitron', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* Jackpot Banner */
        .jackpot-banner {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            background: rgba(255, 204, 0, 0.1);
            padding: 10px 0;
            border-top: 2px solid var(--jackpot-color);
            border-bottom: 2px solid var(--jackpot-color);
            box-shadow: 0 0 15px var(--jackpot-color);
        }

        .jackpot-amount {
            font-size: 2rem;
            color: var(--jackpot-color);
            text-shadow: 0 0 10px var(--jackpot-color);
            display: block;
        }

        .jackpot-timer { font-size: 0.8rem; color: #aaa; }

        .casino-container {
            background: #111;
            padding: 30px;
            border: 2px solid var(--neon-color);
            border-radius: 20px;
            box-shadow: 0 0 20px var(--neon-color);
            text-align: center;
            width: 450px;
            position: relative;
        }

        /* Slot Reels */
        .slot-machine {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            gap: 10px;
        }

        .reel {
            width: 120px;
            height: 120px;
            background: #000;
            border: 2px solid var(--neon-color);
            border-radius: 10px;
            font-size: 3.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .spinning { animation: blur 0.1s infinite; }
        @keyframes blur { 0% { filter: blur(0); } 50% { filter: blur(4px); } 100% { filter: blur(0); } }

        /* Buttons & Controls */
        button {
            background: transparent;
            color: var(--neon-color);
            border: 2px solid var(--neon-color);
            padding: 12px 25px;
            font-family: 'Orbitron';
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            transition: 0.3s;
        }

        button:hover:not(:disabled) { background: var(--neon-color); color: #000; box-shadow: 0 0 20px var(--neon-color); }
        button:disabled { opacity: 0.3; }

        .risk-area { display: none; margin-top: 20px; border-top: 1px solid #333; padding-top: 20px; }
        
        .music-toggle {
            position: absolute; bottom: 10px; left: 10px;
            font-size: 0.7rem; border: 1px solid #444; padding: 5px; color: #444;
        }

        .overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100;
        }

        .hidden { display: none !important; }

        .stats { display: flex; justify-content: space-between; background: #000; padding: 10px; margin-bottom: 10px; border-radius: 5px;}
    </style>
</head>
<body>

    <div id="jackpot-display" class="jackpot-banner">
        <span class="jackpot-timer">N√ÑCHSTER JACKPOT-RESET: <span id="timer">10:00</span></span>
        <span class="jackpot-amount">üé∞ $<span id="jackpot-val">500.000</span> üé∞</span>
    </div>

    <div id="start-overlay" class="overlay">
        <h1>NEON SLOTS</h1>
        <p>Willkommen im 2026er Casino</p>
        <input type="text" id="username" placeholder="Dein Name" style="padding:10px; margin-bottom:15px; background:transparent; border:1px solid var(--neon-color); color:white; font-family:'Orbitron'">
        <button onclick="initGame()">SPIEL STARTEN & MUSIK AN</button>
    </div>

    <div class="casino-container">
        <div class="stats">
            <div><span id="player-name">User</span></div>
            <div style="color: #33ff33;">$<span id="money">100</span></div>
        </div>

        <div style="margin-bottom: 10px;">
            EINSATZ: <input type="number" id="bet-amount" value="10" min="1" style="width: 60px; background: #000; color: #00ffff; border: 1px solid #00ffff; font-family: 'Orbitron'; text-align: center;">
        </div>

        <div class="slot-machine">
            <div class="reel" id="reel1">üíé</div>
            <div class="reel" id="reel2">üíé</div>
            <div class="reel" id="reel3">üíé</div>
        </div>

        <div id="main-controls">
            <button id="spin-btn" onclick="spin()" style="width: 100%;">SPIN</button>
        </div>

        <div id="risk-controls" class="risk-area">
            <div style="margin-bottom: 10px;">AKTUELLER GEWINN: <span id="win-sum" style="color: #33ff33;">0</span>‚Ç¨</div>
            <button onclick="collect()" style="border-color: #33ff33; color: #33ff33;">NEHMEN</button>
            <button onclick="gamble()" style="border-color: #ff3333; color: #ff3333;">RISIKO (x2)</button>
        </div>

        <button class="music-toggle" onclick="toggleMusic()">üéµ MUSIK TOGGLE</button>
        <button onclick="resetGame()" style="font-size: 0.5rem; position: absolute; right: 10px; bottom: 10px; border: none; color: #444;">RESET ACC</button>
    </div>

    <script>
        let money = 100;
        let currentWin = 0;
        let currentUser = "";
        let jackpot = 0;
        let jackpotTime = 600; // 10 Minuten
        let audioStarted = false;
        let bgOscillator;

        // --- JACKPOT "API" LOGIC ---
        function updateJackpotValue() {
            // Simuliert einen API Fetch: Wert zwischen 10k und 1M
            jackpot = Math.floor(Math.random() * (1000000 - 10000 + 1)) + 10000;
            document.getElementById('jackpot-val').innerText = jackpot.toLocaleString();
        }

        function startJackpotTimer() {
            setInterval(() => {
                jackpotTime--;
                if (jackpotTime <= 0) {
                    jackpotTime = 600;
                    updateJackpotValue();
                }
                const mins = Math.floor(jackpotTime / 60);
                const secs = jackpotTime % 60;
                document.getElementById('timer').innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }, 1000);
        }

        // --- MUSIC ENGINE (Web Audio API) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playBackgroundMusic() {
            if (audioStarted) return;
            audioStarted = true;
            
            // Simpler Neon-Synth Loop
            const playNote = (freq, time, length) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(freq, time);
                gain.gain.setValueAtTime(0.02, time);
                gain.gain.exponentialRampToValueAtTime(0.0001, time + length);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(time);
                osc.stop(time + length);
            };

            let tempo = 0;
            setInterval(() => {
                const now = audioCtx.currentTime;
                // Bassline Loop
                const notes = [55, 55, 65.41, 49]; // A1, C2, B1
                playNote(notes[tempo % 4], now, 0.5);
                tempo++;
            }, 500);
        }

        function toggleMusic() {
            if (audioCtx.state === 'running') audioCtx.suspend();
            else audioCtx.resume();
        }

        // --- GAME LOGIC ---
        function initGame() {
            const name = document.getElementById('username').value;
            if (!name) return alert("Name?");
            currentUser = name;
            document.getElementById('player-name').innerText = name;
            document.getElementById('start-overlay').classList.add('hidden');
            
            const saved = localStorage.getItem('neon_v2_' + currentUser);
            if (saved) money = parseInt(saved);
            
            updateJackpotValue();
            startJackpotTimer();
            playBackgroundMusic();
            updateUI();
        }

        function updateUI() {
            document.getElementById('money').innerText = money;
            document.getElementById('win-sum').innerText = currentWin;
            localStorage.setItem('neon_v2_' + currentUser, money);
        }

        async function spin() {
            const bet = parseInt(document.getElementById('bet-amount').value);
            if (money < bet) return alert("Zu arm!");

            money -= bet;
            updateUI();
            
            document.getElementById('spin-btn').disabled = true;
            const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
            reels.forEach(r => r.classList.add('spinning'));

            const symbols = ['üçí', 'üçã', 'üíé', '7Ô∏è‚É£', 'üîî'];
            let results = [];

            for (let i = 0; i < 3; i++) {
                await new Promise(r => setTimeout(r, 600 + i * 400));
                const res = symbols[Math.floor(Math.random() * symbols.length)];
                reels[i].classList.remove('spinning');
                reels[i].innerText = res;
                results.push(res);
            }

            checkResults(results, bet);
        }

        function checkResults(res, bet) {
            if (res[0] === '7Ô∏è‚É£' && res[1] === '7Ô∏è‚É£' && res[2] === '7Ô∏è‚É£') {
                alert("JACKPOT GEKNACKT!!!");
                money += jackpot;
                updateJackpotValue();
                endGame();
            } else if (res[0] === res[1] && res[1] === res[2]) {
                currentWin = bet * 10;
                startRisk();
            } else if (res[0] === res[1] || res[1] === res[2] || res[0] === res[2]) {
                currentWin = bet * 2;
                startRisk();
            } else {
                endGame();
            }
        }

        function startRisk() {
            document.getElementById('main-controls').classList.add('hidden');
            document.getElementById('risk-controls').style.display = 'block';
            updateUI();
        }

        function collect() {
            money += currentWin;
            currentWin = 0;
            endGame();
        }

        async function gamble() {
            if (Math.random() > 0.5) {
                currentWin *= 2;
                updateUI();
            } else {
                currentWin = 0;
                alert("Verloren!");
                endGame();
            }
        }

        function endGame() {
            currentWin = 0;
            document.getElementById('main-controls').classList.remove('hidden');
            document.getElementById('risk-controls').style.display = 'none';
            document.getElementById('spin-btn').disabled = false;
            updateUI();
        }

        function resetGame() {
            if(confirm("Alles l√∂schen?")) {
                localStorage.removeItem('neon_v2_' + currentUser);
                location.reload();
            }
        }
    </script>
</body>
</html>
